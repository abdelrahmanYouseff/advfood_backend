# ๐ ุฏููู ุชูุงูู Noon Payment - ููุชูู

## โ ูุง ุชู ุฅูุฌุงุฒู

ุชู ุฑุจุท ูุธุงู ุงูุฏูุน ุจุงููุงูู ูุน ุจูุงุจุฉ Noon Payment Gateway ุจูุฌุงุญ! ุงูุขู ุนูุฏ ุงูุถุบุท ุนูู "Continue" ูู ุตูุญุฉ ุชูุงุตูู ุงูุนููู:

1. โ ูุชู ุญูุธ ุงูุทูุจ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
2. โ ูุชู ุฅูุดุงุก ุทูุจ ุฏูุน ูู Noon ุจุงููุจูุบ ุงูุตุญูุญ
3. โ ูุชู ุชูุฌูู ุงููุณุชุฎุฏู ูุตูุญุฉ ุงูุฏูุน ุงูุฎุงุตุฉ ุจู Noon
4. โ ุจุนุฏ ุงูุฏูุน ุงููุงุฌุญุ ูุชู ุงูุชูุฌูู ูุตูุญุฉ ุงููุทุงุนู
5. โ ูุธูุฑ ุจูุจ ุงุจ ุฌููู ุจุชูุงุตูู ุงูุทูุจ ุงููุงููุฉ

---

## ๐ ุณูุฑ ุงูุนูู ุงููุงูู

### 1๏ธโฃ ุงุฎุชูุงุฑ ุงููุทุนู ูุงูููุชุฌุงุช
```
URL: http://127.0.0.1:8000/rest-link
```
- ุงููุณุชุฎุฏู ูุฎุชุงุฑ ูุทุนู
- ูุถูู ุงูููุชุฌุงุช ููุณูุฉ
- ุงูุจูุงูุงุช ุชูุญูุธ ูู `sessionStorage`

### 2๏ธโฃ ุฅุฏุฎุงู ุชูุงุตูู ุงูุนููู
```
URL: http://127.0.0.1:8000/checkout/customer-details
```

**ุงูุจูุงูุงุช ุงููุทููุจุฉ:**
- ุงูุงุณู ุงููุงูู
- ุฑูู ุงููุงุชู
- ุฑูู ุงููุจูู
- ุงูุทุงุจู
- ุฑูู ุงูุดูุฉ
- ุงุณู ุงูุดุงุฑุน
- ููุงุญุธุงุช (ุงุฎุชูุงุฑู)

### 3๏ธโฃ ุงูุถุบุท ุนูู "Continue"

**ูุง ูุญุฏุซ ุชููุงุฆูุงู:**

1. **ุงูุชุญูู ูู ุงูุจูุงูุงุช**
   - ูุชู ุงูุชุฃูุฏ ูู ูุฌูุฏ ููุชุฌุงุช ูู ุงูุณูุฉ
   - ูุชู ุงูุชุฃูุฏ ูู ุตุญุฉ ุงููุจูุบ

2. **ุฅุฑุณุงู ุทูุจ ุฅูู ุงูุฎุงุฏู**
   ```javascript
   POST: /checkout/initiate-payment
   ```
   
3. **ุญูุธ ุงูุทูุจ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช**
   - ูุชู ุฅูุดุงุก ุณุฌู ุฌุฏูุฏ ูู ุฌุฏูู `link_orders`
   - ูุญุชูู ุนูู ุฌููุน ุจูุงูุงุช ุงูุนููู ูุงูุทูุจ

4. **ุฅูุดุงุก ุทูุจ ุฏูุน ูู Noon**
   ```json
   {
     "apiOperation": "INITIATE",
     "order": {
       "amount": 150.50,
       "currency": "SAR",
       "reference": "ORDER-1-1759302507",
       "name": "Order #1",
       "category": "pay"
     },
     "configuration": {
       "returnUrl": "https://advfoodapp.clarastars.com/payment-success?order_id=1",
       "paymentAction": "AUTHORIZE"
     }
   }
   ```

5. **ุงุณุชูุงู ุฑุฏ ูู Noon**
   ```json
   {
     "success": true,
     "checkout_url": "https://pay-test.sa.noonpayments.com/...",
     "order_id": 1
   }
   ```

6. **ุงูุชูุฌูู ุงูุชููุงุฆู ูุตูุญุฉ Noon**
   - ุงููุชุตูุญ ูููุฌููู ุชููุงุฆูุงู ูุตูุญุฉ ุงูุฏูุน
   - ุงููุณุชุฎุฏู ูุฏุฎู ุจูุงูุงุช ุจุทุงูุชู
   - Noon ูุนุงูุฌ ุงูุฏูุน

### 4๏ธโฃ ุจุนุฏ ูุฌุงุญ ุงูุฏูุน

**ุงูุชูุฌูู ุงูุชููุงุฆู:**
```
http://127.0.0.1:8000/rest-link?order_id=1&payment_status=success
```

**ูุธูุฑ ุจูุจ ุงุจ ุฌููู ูุญุชูู ุนูู:**

#### ๐ฏ ุฑุฃุณ ุงูุจูุจ ุงุจ
- โ ุฃููููุฉ ูุฌุงุญ ูุชุญุฑูุฉ (Checkmark Animation)
- ๐ ุนููุงู: "ุชู ุงูุฏูุน ุจูุฌุงุญ!"
- ๐ ุฎูููุฉ ุฌูููุฉ ุจุชุฏุฑุฌ ุฃุฎุถุฑ

#### ๐ ูุนูููุงุช ุงูุนููู
- ๐ค ุงูุงุณู ุงููุงูู
- ๐ฑ ุฑูู ุงููุงุชู
- ๐ ุงูุนููุงู ุงููุงูู (ุงููุจููุ ุงูุทุงุจูุ ุงูุดูุฉุ ุงูุดุงุฑุน)
- ๐ ุงูููุงุญุธุงุช (ุฅู ูุฌุฏุช)

#### ๐ ุชูุงุตูู ุงูุทูุจ
- ูุงุฆูุฉ ุงูููุชุฌุงุช ูุน ุงููููุฉ ูุงูุณุนุฑ
- ุงููุฌููุน ุงูููู
- ุงุณู ุงููุทุนู

#### โฐ ุญุงูุฉ ุงูุทูุจ
- "ููุฏ ุงูุชุญุถูุฑ"
- ุงูููุช ุงููุชููุน: 15-25 ุฏูููุฉ

#### ๐ ุฃุฒุฑุงุฑ ุงูุฅุฌุฑุงุกุงุช
- **ูุงุชุณุงุจ:** ููุชูุงุตู ูุน ุงููุทุนู
- **ุฅุบูุงู:** ูุฅุบูุงู ุงูุจูุจ ุงุจ

---

## ๐จ ุงูุชุตููู

### ุงูุจูุจ ุงุจ ูุชุถูู:
- โจ **Animation ูุฐููุฉ:** 
  - FadeIn ููุฎูููุฉ
  - SlideUp ููุจูุจ ุงุจ
  - ScaleUp ููุฃููููุฉ
  - Checkmark Animation

- ๐จ **ุฃููุงู ุฌูููุฉ:**
  - ุฃุฎุถุฑ ูููุฌุงุญ
  - ุฃุฒุฑู ูููุนูููุงุช
  - ุฃุตูุฑ ูุญุงูุฉ ุงูุทูุจ
  - ุฑูุงุฏู ูููุญุชูู

- ๐ฑ **Responsive:**
  - ูุนูู ุนูู ุฌููุน ุงูุฃุญุฌุงู
  - ุชุตููู ูุชุฌุงูุจ 100%

---

## ๐๏ธ ุงููููุงุช ุงููุนุฏูุฉ

### 1. **Backend (PHP)**

#### `app/Http/Controllers/RestLinkController.php`
```php
// ุฅุถุงูุฉ method ุฌุฏูุฏ
public function initiatePayment(Request $request)
{
    // ุญูุธ ุงูุทูุจ
    // ุฅูุดุงุก ุทูุจ Noon
    // ุฅุฑุฌุงุน checkout URL
}

// ุชุนุฏูู method
public function index(Request $request)
{
    // ุชูุฑูุฑ ุจูุงูุงุช ุงูุทูุจ ููุตูุญุฉ
    $order = LinkOrder::find($request->get('order_id'));
    return view('rest-link', compact('order'));
}
```

#### `app/Http/Controllers/TestNoonController.php`
```php
// ุชุนุฏูู method ุงููุฌุงุญ
public function success(Request $request)
{
    // ุงูุชูุฌูู ูุตูุญุฉ rest-link ูุน order_id
    return redirect()->route('rest-link', [
        'order_id' => $orderId,
        'payment_status' => 'success'
    ]);
}
```

### 2. **Frontend (Blade)**

#### `resources/views/checkout/customer-details.blade.php`
```javascript
// ุชุนุฏูู submitForm function
function submitForm(event) {
    // ุฌูุน ุงูุจูุงูุงุช
    // ุฅุฑุณุงู ุทูุจ ุฅูู /checkout/initiate-payment
    // ุงูุชูุฌูู ูุตูุญุฉ Noon
}
```

#### `resources/views/rest-link.blade.php`
```blade
// ุฅุถุงูุฉ ุจูุจ ุงุจ ุงููุฌุงุญ
@if($order && request()->get('payment_status') === 'success')
    <div id="successPopup">
        <!-- ุงูุจูุจ ุงุจ ุงูุฌููู -->
    </div>
@endif
```

### 3. **Routes**

#### `routes/web.php`
```php
// ุฅุถุงูุฉ route ุฌุฏูุฏ
Route::post('/checkout/initiate-payment', [RestLinkController::class, 'initiatePayment'])
    ->name('checkout.initiate-payment');
```

### 4. **Configuration**

#### `config/noon.php`
```php
'defaults' => [
    'currency' => 'SAR',
    'category' => 'pay', // โ ุชู ุงูุชุบููุฑ ูู 'general' ุฅูู 'pay'
    'channel' => 'web',
],
```

---

## ๐งช ููููุฉ ุงูุงุฎุชุจุงุฑ

### ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ ุงููุงููุฉ:

1. **ุงูุชุญ ุตูุญุฉ ุงููุทุงุนู**
   ```
   http://127.0.0.1:8000/rest-link
   ```

2. **ุงุฎุชุฑ ูุทุนู ูุฃุถู ููุชุฌุงุช**
   - ุงููุฑ ุนูู ูุทุนู
   - ุฃุถู ุจุนุถ ุงูููุชุฌุงุช ููุณูุฉ
   - ุงููุฑ "Checkout"

3. **ุฃุฏุฎู ุชูุงุตูู ุงูุนููู**
   - ุงููุฃ ุฌููุน ุงูุญููู
   - ุงุถุบุท "Continue"

4. **ุณุชููุฌููู ุชููุงุฆูุงู ูุตูุญุฉ Noon**
   - ุงุณุชุฎุฏู ุจุทุงูุงุช ุงูุงุฎุชุจุงุฑ:
     - **ูุฌุงุญ:** 4111 1111 1111 1111
     - **ูุดู:** 4000 0000 0000 0002
     - CVV: ุฃู 3 ุฃุฑูุงู
     - ุชุงุฑูุฎ: ุฃู ุชุงุฑูุฎ ูุณุชูุจูู

5. **ุฃููู ุงูุฏูุน**
   - ุฃุฏุฎู ุจูุงูุงุช ุงูุจุทุงูุฉ
   - ุงุถุบุท "Pay"

6. **ุณุชููุฌููู ุชููุงุฆูุงู ูุตูุญุฉ ุงููุทุงุนู**
   - ุณูุธูุฑ ุงูุจูุจ ุงุจ ุงูุฌููู
   - ูุญุชูู ุนูู ุฌููุน ุชูุงุตูู ุงูุทูุจ
   - ููููู ุงูุชูุงุตู ุนุจุฑ ูุงุชุณุงุจ

---

## ๐ ุจูุงูุงุช Noon ุงููุณุชุฎุฏูุฉ

```yaml
Business ID: adv_food
Application ID: adv-food
Category: pay
Currency: SAR
Amount Range: 0-50,000 SAR
Card Schemes: VISA, MASTERCARD, MADA, ApplePay
Environment: test (Sandbox)
```

---

## ๐ ุงูุฃูุงู

- โ CSRF Token ูุญูู
- โ Validation ููุจูุงูุงุช
- โ HTTPS ูู ุงูุฅูุชุงุฌ
- โ ูุง ูุชู ุญูุธ ุจูุงูุงุช ุงูุจุทุงูุฉ
- โ Noon ูุชููู ูุนุงูุฌุฉ ุงูุฏูุน

---

## ๐ ุงูุงูุชูุงู ููุฅูุชุงุฌ

ุนูุฏ ุงูุงุณุชุนุฏุงุฏ ููุฅูุชุงุฌ:

1. **ุบููุฑ ุงูุจูุฆุฉ ูู `.env`:**
   ```env
   NOON_ENVIRONMENT=production
   NOON_API_URL=https://api.sa.noonpayments.com
   NOON_API_KEY=your_production_api_key
   ```

2. **ุชุฃูุฏ ูู ุงูุฏูููู ุงูุตุญูุญ:**
   ```env
   APP_URL=https://advfoodapp.clarastars.com
   NOON_SUCCESS_URL=https://advfoodapp.clarastars.com/payment-success
   NOON_FAILURE_URL=https://advfoodapp.clarastars.com/payment-failed
   ```

3. **ูุธู ุงููุงุด:**
   ```bash
   php artisan config:clear
   php artisan cache:clear
   ```

---

## ๐ฑ ููุทุงุช ุงูุดุงุดุฉ

### 1. ุตูุญุฉ ุชูุงุตูู ุงูุนููู
- ูููุฐุฌ ุฌููู ูุฅุฏุฎุงู ุงูุจูุงูุงุช
- ุฒุฑ "Continue" ููุฌู ูู Noon

### 2. ุตูุญุฉ ุฏูุน Noon
- ุตูุญุฉ Noon ุงูุขููุฉ
- ุฅุฏุฎุงู ุจูุงูุงุช ุงูุจุทุงูุฉ

### 3. ุงูุจูุจ ุงุจ ุจุนุฏ ุงููุฌุงุญ
- โ ุฃููููุฉ ูุฌุงุญ ูุชุญุฑูุฉ
- ๐ ุชูุงุตูู ุงูุทูุจ ุงููุงููุฉ
- ๐ค ูุนูููุงุช ุงูุนููู
- ๐ ุงูููุชุฌุงุช ูุงููุจูุบ
- ๐ ุนููุงู ุงูุชูุตูู
- โฐ ุญุงูุฉ ุงูุทูุจ
- ๐ฌ ุฒุฑ ูุงุชุณุงุจ

---

## ๐ฏ ุงููููุฒุงุช

- โ **ุณูู ุงูุงุณุชุฎุฏุงู:** 3 ุฎุทูุงุช ููุท
- โ **ุขูู 100%:** Noon ูุนุชูุฏ ููุฑุฎุต
- โ **ุณุฑูุน:** ูุนุงูุฌุฉ ููุฑูุฉ
- โ **ุฌููู:** ุชุตููู ุนุตุฑู ูุงุญุชุฑุงูู
- โ **ูุชุฌุงูุจ:** ูุนูู ุนูู ุฌููุน ุงูุฃุฌูุฒุฉ
- โ **ูุชุนุฏุฏ ุงููุบุงุช:** ุนุฑุจู ูุฅูุฌููุฒู
- โ **ุชุชุจุน ุงูุทูุจุงุช:** ุฑูู ุทูุจ ูุฑูุฏ
- โ **ูุงุชุณุงุจ:** ุชูุงุตู ูุจุงุดุฑ

---

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดููุฉ:

1. **ูุญุต ุงูุณุฌูุงุช:**
   ```bash
   tail -f storage/logs/laravel.log
   ```

2. **ุงูุชุญูู ูู ุงูุจูุงูุงุช:**
   - ุชุฃูุฏ ูู ูุฌูุฏ API Key
   - ุชุฃูุฏ ูู ุตุญุฉ business_id
   - ุชุฃูุฏ ูู ูุฌูุฏ ููุชุฌุงุช ูู ุงูุณูุฉ

3. **ุงุฎุชุจุฑ ุงูุงุชุตุงู:**
   ```
   http://127.0.0.1:8000/test-noon/create-payment
   ```

---

## โ ุชู ุจูุฌุงุญ!

๐ **ุชู ุฅููุงู ุงูุชูุงูู ุจูุฌุงุญ!**

ุงููุธุงู ุงูุขู ุฌุงูุฒ ููุงุณุชุฎุฏุงู. ูููู ููุนููุงุก:
- ุงุฎุชูุงุฑ ุงููุทุงุนู ูุงูููุชุฌุงุช
- ุฅุฏุฎุงู ุจูุงูุงุชูู
- ุงูุฏูุน ุนุจุฑ Noon ุจุฃูุงู
- ุฑุคูุฉ ุชูุงุตูู ุทูุจูู ูู ุจูุจ ุงุจ ุฌููู
- ุงูุชูุงุตู ูุน ุงููุทุนู ุนุจุฑ ูุงุชุณุงุจ

---

**ุขุฎุฑ ุชุญุฏูุซ:** 1 ุฃูุชูุจุฑ 2025  
**ุงูุญุงูุฉ:** โ ููุชูู ูุฌุงูุฒ  
**ุงูุฅุตุฏุงุฑ:** 1.0.0

